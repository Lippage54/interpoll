from telegram import Update, Poll
from telegram.ext import Updater, CommandHandler, CallbackContext
import random
import os

# üîß –í—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–≤–æ–π —Ç–æ–∫–µ–Ω
TELEGRAM_BOT_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")

if not TELEGRAM_BOT_TOKEN:
    raise ValueError("TELEGRAM_BOT_TOKEN –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!")

# –ò–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
print(f"–¢–æ–∫–µ–Ω (–æ–±—Ä–µ–∑–∞–Ω): {TELEGRAM_BOT_TOKEN[:5]}...")  # –Ω–µ –ø–µ—á–∞—Ç–∞–π –≤–µ—Å—å —Ç–æ–∫–µ–Ω –≤ –ª–æ–≥!

# üìã –ì–æ—Ç–æ–≤—ã–µ –æ–ø—Ä–æ—Å—ã
polls = [
    {
        "question": "–ö–∞–∫–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–±–µ –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è?",
        "options": ["Python", "JavaScript", "C++", "Java"]
    },
    {
        "question": "–ö–∞–∫–æ–π —É —Ç–µ–±—è —É—Ä–æ–≤–µ–Ω—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏?",
        "options": ["–ù–∞—á–∏–Ω–∞—é—â–∏–π", "–°—Ä–µ–¥–Ω–∏–π", "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π"]
    },
    {
        "question": "–ß—Ç–æ —Ç—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å?",
        "options": ["Frontend", "Backend", "Fullstack"]
    }
]

# üì• –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
def start(update: Update, context: CallbackContext):
    chat_id = update.effective_chat.id
    poll = random.choice(polls)
    
    context.bot.send_poll(
        chat_id=chat_id,
        question=poll["question"],
        options=poll["options"],
        is_anonymous=False,
        allows_multiple_answers=False
    )

# üöÄ –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—É—Å–∫
def main():
    updater = Updater(TELEGRAM_BOT_TOKEN, use_context=True)
    dp = updater.dispatcher

    dp.add_handler(CommandHandler("start", start))

    updater.start_polling()
    updater.idle()

if __name__ == '__main__':

    main()

